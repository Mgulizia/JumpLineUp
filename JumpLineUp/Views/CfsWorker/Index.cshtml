@using System.Web.UI.WebControls
@model IEnumerable<JumpLineUp.Models.CfsWorker>
@{
    ViewBag.Title = "CfsWorker";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<br/>
<div class="panel panel-default">

    <div class="panel-heading">
        <div class="btn-toolbar pull-right" style="margin: 14px 0px;">
            @Html.ActionLink("Add CFS Worker", "NewCfsWorker", "CfsWorker", new {@class = "btn btn-primary"})
            @Html.ActionLink("View Disabled CFS Workers", "Disabled", "CfsWorker", new { @class = "btn btn-primary" })
        </div>
        <h2>DHHS CFS Workers</h2>
    </div><!--Panel Heading End-->
    <div class="panel-body">
        <div class="well">
            @if (!Model.Any())
            {
                <p>There are Currently no CFS Workers in LineUp, @Html.ActionLink("add one now?", "NewCfsWorker", "CfsWorker") </p>
            }
            else
            {
                <table id="cfsTables" class="table table-responsive table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone Number</th>
                            <th>Email</th>
                            <th>Edit</th>
                        </tr>
                    </thead>
                    <tbody>
                    @foreach (var cfs in Model)
                    {
                        <tr>
                            <td>@cfs.FirstName @cfs.LastName</td>
                            <td><a href="tel:@cfs.Phone">@cfs.FormatPhone()</a> </td>
                            <td><a href="mailto:@cfs.Email">@cfs.Email</a> </td>
                            <td>
                                <a href="@Url.Action("EditCfsWorker", "CfsWorker", new {id = cfs.Id})" class="btn btn-sm btn-default">Edit &nbsp; <span class="glyphicon glyphicon-pencil"></span></a>
                                <button data-toggle-type="disable" data-cfsworker-id="@cfs.Id" class="js-toggle btn btn-sm btn-default ">
                                    Disable &nbsp; <span class="glyphicon glyphicon-ban-circle"></span>
                                </button>
                            </td>
                        </tr>
                    }
                    </tbody>
                                
                </table>
            }
        </div><!-- End of Well-->
    </div><!--Panel Body End-->
</div>

@section scripts
{
    <script>
    $(document).ready(function () {
        var message = "Are you sure you wish to disable this CFS Worker?";
        var tableName = "#cfsTables";
        var toggleButton = ".js-toggle";
        var url = "api/CfsWorkers/";
        var btnDataId = "data-cfsworker-id";

        $(tableName).DataTable();


        $(tableName).on("click", toggleButton, function () {

            var button = $(this);

            bootbox.confirm(message, function(result) {
                if (result) {
                    $.ajax({
                        url: url + button.attr(btnDataId),
                        method: "DELETE",
                        success: function () {
                            button.parents("tr").remove();
                        }
                    });
                }
            });
        });
    })
    </script>
}
